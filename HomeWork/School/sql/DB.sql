
-- 1/ Tạo DB + Sử dụng DB
	CREATE DATABASE DB;
    
	USE DB;
	
-- 2/ Tạo bảng + Khoá chính
	CREATE TABLE GIAOVIEN
	(
		MAGV CHAR(3),
		HOTEN VARCHAR(50),
		LUONG FLOAT,
		PHAI CHAR(3),
		NGSINH DATE,
		DIACHI VARCHAR(50),
		GVQLCM CHAR(3),
		MABM CHAR(4),
		PRIMARY KEY(MAGV)
	);
    
	CREATE TABLE BOMON
	(
		MABM CHAR(4),
		TENBM VARCHAR(50),
		PHONG CHAR(3),
		DIENTHOAI CHAR(11),
		TRUONGBM CHAR(3),
		MAKHOA CHAR(4),
		NGAYNHANCHUC DATE,
		PRIMARY KEY(MABM)
	);
    
	CREATE TABLE KHOA
	(
		MAKHOA CHAR(4),
		TENKHOA VARCHAR(50),
		NAMTL INT,
		PHONG CHAR(3),
		DIENTHOAI CHAR(10),
		TRUONGKHOA CHAR(3),
		NGAYNHANCHUC DATE,
		PRIMARY KEY(MAKHOA)
	);
	
    CREATE TABLE CHUDE
	(
		MACD CHAR(4),
		TENCD VARCHAR(30),
		PRIMARY KEY(MACD)
	);
    
	CREATE TABLE DETAI
	(
		MADT CHAR(4),
		TENDT VARCHAR(50),
		CAPQL VARCHAR(20),
		KINHPHI FLOAT,
		NGAYBD DATE,
		NGAYKT DATE,
		MACD CHAR(4),
		GVCNDT CHAR(3),
		PRIMARY KEY(MADT)
	);
    
ALTER TABLE DETAI
MODIFY TENDT VARCHAR(100);
    
	CREATE TABLE CONGVIEC 
	(
		MADT CHAR(4),
		STT INT,
		TENCV VARCHAR(50),
		NGAYBD DATE,
		NGAYKT DATE,
		PRIMARY KEY(MADT,STT)
	);
	
	CREATE TABLE THAMGIADT
	(
		MAGV CHAR(3),
		MADT CHAR(4),
		STT INT,
		PHUCAP FLOAT,
		KETQUA VARCHAR(10),
		PRIMARY KEY(MAGV,MADT,STT)
	);
    
	CREATE TABLE GV_DT
	(
		MAGV CHAR(3),
		DIENTHOAI CHAR(10),
		PRIMARY KEY(MAGV,DIENTHOAI)
	);
    
	CREATE TABLE NGUOITHAN
	(
		MAGV CHAR(3),
		TEN VARCHAR(12),
		NGSINH DATE,
		PHAI CHAR(3),
		PRIMARY KEY(MAGV,TEN)
	);
	
-- 3/ Tạo khoá ngoại

#Tạo khóa ngoại ở bảng GIAOVIEN
	ALTER TABLE GIAOVIEN
		ADD CONSTRAINT FK1_GVQLCM 
        FOREIGN KEY (GVQLCM)
		REFERENCES GIAOVIEN(MAGV);
        
	ALTER TABLE GIAOVIEN
		ADD CONSTRAINT FK2_MABM
		FOREIGN KEY (MABM)
		REFERENCES BOMON(MABM);

ALTER TABLE GIAOVIEN
DROP FOREIGN KEY FK2_MABM;

#Tạo khóa ngoại ở bảng BOMON
	ALTER TABLE BOMON
		ADD CONSTRAINT FK3_TRUONGBM
		FOREIGN KEY (TRUONGBM)
		REFERENCES GIAOVIEN(MAGV);
        
	ALTER TABLE BOMON
		ADD CONSTRAINT FK4_MAKHOA
		FOREIGN KEY (MAKHOA)
		REFERENCES KHOA(MAKHOA);
     
#Tạo khóa ngoại ở bảng KHOA
	ALTER TABLE KHOA
		ADD CONSTRAINT FK5_TRUONGKHOA
		FOREIGN KEY (TRUONGKHOA)
		REFERENCES GIAOVIEN(MAGV);
     
	
#Tạo khóa ngoại ở bảng DETAI
	ALTER TABLE DETAI
		ADD CONSTRAINT FK6_MACD
		FOREIGN KEY (MACD)
		REFERENCES CHUDE(MACD);
		
	ALTER TABLE DETAI
		ADD CONSTRAINT FK7_GVCNDT
		FOREIGN KEY (GVCNDT)
		REFERENCES GIAOVIEN(MAGV);
     
#Tạo khóa ngoại ở bảng CONGVIEC
	ALTER TABLE CONGVIEC
		ADD CONSTRAINT FK8_MADT
		FOREIGN KEY (MADT)
		REFERENCES DETAI(MADT);
        
        
#Tạo khoá ngoại ở bảng THAMGIADT
	ALTER TABLE THAMGIADT
		ADD CONSTRAINT FK9_MAGV
		FOREIGN KEY (MAGV)
		REFERENCES GIAOVIEN(MAGV);
        
	ALTER TABLE THAMGIADT
		ADD CONSTRAINT FK10_MADT
		FOREIGN KEY (MADT, STT)
		REFERENCES CONGVIEC(MADT,STT);
	
#Tạo khóa ngoại ở bảng GV_DT
	ALTER TABLE GV_DT
		ADD CONSTRAINT FK11_MAGV
		FOREIGN KEY (MAGV)
		REFERENCES GIAOVIEN(MAGV);
        
#Tạo khóa ngoại ở bảng NGUOITHAN
	ALTER TABLE NGUOITHAN
		ADD CONSTRAINT FK12_MAGV
		FOREIGN KEY (MAGV)
		REFERENCES GIAOVIEN(MAGV);
        
	

		
-- 4/ Nhập data
#Nhập data cho bảng GIAOVIEN
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI)
	VALUES ('001','Nguyễn Hoài An',2000.0,'Nam','1983-02-15','25/3 Lạc Long Quân, Q.10,TP HCM');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI)
	VALUES ('002','Trần Trà Hương',2500.0,'Nữ','1994-06-20','125 Trần Hưng Đạo, Q.1, TP HCM');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI,GVQLCM)
	VALUES ('003','Nguyễn Ngọc Ánh',2200.0,'Nữ','1975-05-11','12/21 Võ Văn Ngân Thủ Đức, TP HCM','002');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI)
	VALUES ('004','Trương Nam Sơ',2300.0,'Nam','1999-06-20','215 Lý Thường Kiệt,TP Biên Hòa');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI)
	VALUES ('005','Lý Hoàng Hà',2600.0,'Nam','1970-10-23','22/5 Nguyễn Xí, Q.Bình Thạnh, TP HCM');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI,GVQLCM)
	VALUES ('006','Trần Bạch Tuyết',1500.0,'Nữ','1989-05-20','127 Hùng Vương, TP Mỹ Tho','004');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI)
	VALUES ('007','Nguyễn An Trung',2100.0,'Nam','1990-06-05','234 3/2, TP Biên Hòa');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI,GVQLCM)
	VALUES ('008','Trần Trung Hiếu',1800.0,'Nam','1977-08-06','22/11 Lý Thường Kiệt,TP Mỹ Tho','007');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI,GVQLCM)
	VALUES ('009','Trần Hoàng nam',2000.0,'Nam','1975-11-22','234 Trấn Não,An Phú, TP HCM','001');
	INSERT INTO GIAOVIEN(MAGV,HOTEN,LUONG,PHAI,NGSINH,DIACHI,GVQLCM)
	VALUES ('010','Phạm Nam Thanh',1500.0,'Nam','1980-12-12','221 Hùng Vương,Q.5, TP HCM','007');
	

#Nhập data cho bảng BOMON
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,MAKHOA)
	VALUES ('CNTT','Công nghệ tri thức','B15','0838126126','CNTT');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,MAKHOA)
	VALUES ('HHC','Hóa hữu cơ','B44','0838222222','HH');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,MAKHOA)
	VALUES ('CH','Cơ học','B42','0838878787','VL');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,TRUONGBM,MAKHOA,NGAYNHANCHUC)
	VALUES ('HPT','Hóa phân tích','B43','0838777777','007','HH','2007-10-15');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,TRUONGBM,MAKHOA,NGAYNHANCHUC)
	VALUES ('HTTT','Hệ thống thông tin','B13','0838125125','002','CNTT','2004-09-20');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,TRUONGBM,MAKHOA,NGAYNHANCHUC)
	VALUES ('MMT','Mạng máy tính','B16','0838676767','001','CNTT','2005-05-15');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,MAKHOA)
	VALUES ('TUD','Toán ứng dụng','B33','0838898989','TH');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,MAKHOA)
	VALUES ('VLĐT','Vật lý điện tử','B23','0838234234','VL');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,TRUONGBM,MAKHOA,NGAYNHANCHUC)
	VALUES ('KTPM','Kỹ thuật phần mềm','B24','0838454545','005','CNTT','2006-02-18');
	INSERT INTO BOMON(MABM,TENBM,PHONG,DIENTHOAI,TRUONGBM,MAKHOA,NGAYNHANCHUC)
	VALUES ('TT','Toán tin','B32','0838909090','004','TH','2007-01-01');
	

#Nhập data cho bảng KHOA
	INSERT INTO KHOA(MAKHOA,TENKHOA,NAMTL,PHONG,DIENTHOAI,TRUONGKHOA,NGAYNHANCHUC)
	VALUES ('CNTT','Công nghệ thông ti',1995,'B11','0838123456','002','2005-02-20');
	INSERT INTO KHOA(MAKHOA,TENKHOA,NAMTL,PHONG,DIENTHOAI,TRUONGKHOA,NGAYNHANCHUC)
	VALUES ('HH','Hóa học',1982,'B41','0838456456','007','2001-10-15');
	INSERT INTO KHOA(MAKHOA,TENKHOA,NAMTL,PHONG,DIENTHOAI,TRUONGKHOA,NGAYNHANCHUC)
	VALUES ('TH','Toán học',1980,'B31','0838454545','004','2000-10-11');
	INSERT INTO KHOA(MAKHOA,TENKHOA,NAMTL,PHONG,DIENTHOAI,TRUONGKHOA,NGAYNHANCHUC)
	VALUES ('VL','Vật lý',1976,'B21','0838223223','005','2003-09-18');
	
    
#Nhập data cho bảng CHUDE
	INSERT INTO CHUDE(MACD,TENCD)
	VALUES ('NCPT', 'Nghiên cứu phát triển');
	INSERT INTO CHUDE(MACD,TENCD)
	VALUES ('QLGD', 'Quản lý giáo dục');
	INSERT INTO CHUDE(MACD,TENCD)
	VALUES ('UDC', 'Ứng dụng công nghệ');
	
#Nhập data cho bảng DETAI
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('001','HTTT quản lý các trường ĐH','ĐHQG',20.0,'2007-10-20','2008-10-20','QLGD','002');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('002','HTTT quản lý giáo vụ cho một Khoa','Trường',60.0,'2000-10-12','2001-10-12','QLGD','002');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('003','Nghiên cứu phương pháp tối ưu bài toán xấp xỉ đa thức','ĐHQG',100.0,'2008-05-15','2010-05-15','NCPT','005');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('004','Tạo vật liệu mới ứng dụng trong xây dựng công trình','Nhà nước',100.0,'2007-01-01','2009-12-31','NCPT','004');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('005','Ứng dụng hóa học xanh','Trường',200.0,'2003-10-10','2004-12-10','UDC','007');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('006','Nghiên cứu chuyển động của hệ mặt trời','Nhà nước',4000.0,'2006-10-12','2009-10-12','NCPT','004');
	INSERT INTO DETAI(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
	VALUES ('007','HTTT quản lý thư viện ở các trường ĐH','Trường',9.0,'2009-05-10','2010-05-10','QLGD','001');
	
#Nhập data cho bảng CONGVIEC
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('001',1,'Khởi tạo và Lập kế hoạch','2007-10-20','2008-12-20');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('001',2,'Xác định yêu cầu','2008-12-21','2008-03-21');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('001',3,'Phân tích hệ thống','2008-03-22','2008-05-22');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('001',4,'Thiết kế hệ thống','2008-05-23','2008-06-23');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('001',5,'Cài đặt thử nghiệm','2008-06-24','2008-10-20');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('002',1,'Khởi tạo và lập kế hoạch','2009-05-10','2009-07-10');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('002',2,'Xác định yêu cầu','2009-07-11','2009-10-11');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('002',3,'Phân tích hệ thống','2009-10-12','2009-12-20');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('002',4,'Thiết kế hệ thống','2009-12-21','2010-03-22');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('002',5,'Cài đặt thử nghiệm','2010-03-23','2010-05-10');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('006',1,'Chế tạo sản phẩm','2006-10-20','2007-02-20');
	INSERT INTO CONGVIEC(MADT,STT,TENCV,NGAYBD,NGAYKT)
	VALUES ('006',2,'Nghiên cứu khoa học','2007-02-21','2008-09-21');
	
	
#Nhập data cho bảng THAMGIADT
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP)
	VALUES ('001','002',1,0.0);
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP)
	VALUES ('001','002',2,2.0);
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('002','001',4,2.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('003','001',1,1.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('003','001',2,0.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('003','001',4,1.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP)
	VALUES ('003','002',2,0.0);
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('004','006',1,0.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('004','006',2,1.0,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP,KETQUA)
	VALUES ('006','006',2,1.5,'Đạt');
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP)
	VALUES ('009','002',3,0.5);
	INSERT INTO THAMGIADT(MAGV,MADT,STT,PHUCAP)
	VALUES ('009','002',4,1.5);
	

#Nhập data cho bảng GV_DT
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('001','0838912009');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('001','0903532088');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('002','0956462907');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('003','0838151075');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('003','0903530968');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('003','0937125609');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('006','0937860731');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('008','0653707189');
	INSERT INTO GV_DT(MAGV,DIENTHOAI)
	VALUES ('008','0913214201');
	
	
#Nhập data cho bảng NGUOITHAN
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('001','Hùng','1990-01-14','Nam');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('001','Thủy','1994-12-08','Nữ');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('003','Hà','1998-09-03','Nữ');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('003','Thu','1998-09-03','Nữ');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('007','Mai','2003-03-26','Nữ');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('007','Vy','2000-02-14','Nữ');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('008','Nam','1991-05-06','Nam');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('009','An','1996-08-19','Nam');
	INSERT INTO NGUOITHAN(MAGV,TEN,NGSINH,PHAI)
	VALUES ('010','Nguyệt','2006-01-14','Nữ');
	
	

#Cập nhật thêm dữ liệu cho bảng GIAOVIEN
	UPDATE GIAOVIEN SET MABM = 'MMT'  WHERE (MAGV = '001');
	UPDATE GIAOVIEN SET MABM = 'HTTT' WHERE (MAGV = '002');
	UPDATE GIAOVIEN SET MABM = 'HTTT' WHERE (MAGV = '003');
	UPDATE GIAOVIEN SET MABM = 'CH'   WHERE (MAGV = '004');
	UPDATE GIAOVIEn SET MABM = 'VLĐT' WHERE (MAGV = '005');
	UPDATE GIAOVIEN SET MABM = 'TT'   WHERE (MAGV = '006');
	UPDATE GIAOVIEN SET MABM = 'KTPM' WHERE (MAGV = '007');
	UPDATE GIAOVIEN SET MABM = 'HPT'  WHERE (MAGV = '008');
	UPDATE GIAOVIEN SET MABM = 'MMT'  WHERE (MAGV = '009');
    UPDATE GIAOVIEN SET MABM = 'TUD'  WHERE (MAGV = '010');
